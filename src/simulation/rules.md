# 游戏规则

每场游戏指定一张地图 (map)，由 $n$ 行 $m$ 列地图格组成。

## 先后手确定规则

每刻开始时，对所有玩家随机分配一个优先级权重（不可重复），由优先级高的玩家先操作。
优先级权重不作为接口提供给玩家。

## 游戏操作

以下讨论的操作均不能越过地图边界。

### 移动

每刻开始时，玩家选择一个士兵数量为 $k\ (k > 1)$ 的己方领地，则玩家可选的移动操作有：

1. 移动 $k - 1$ 个士兵到上下左右相邻的地图格
2. 移动 $\lfloor k / 2 \rfloor$ 个士兵到上下左右相邻的地图格

设移动的士兵数量为 $k'$，当前己方领地士兵数量变为 $k - k'$。

若移动到：
1. 山地，则移动失败，山地地图格不可占领。
2. 己方领地，设己方领地原有士兵数量为 $a$，则己方领地此时士兵数量变为 $a + k'$。
3. 非己方领地非山地地图格，开始占领操作。

### 占领

设移动的士兵数量为 $k'$，当士兵移动到以下非己方领地非山地地图格时：

1. 空地：占领，成为玩家领地。
2. 城堡：设城堡士兵数量为 $x$
若 $k' \leq x$，则占领失败，此时城堡士兵数量变为 $x - k'$（注意 $x - k' = 0$ 同时未被占领是合法的），原移动的 $k'$ 个士兵被消灭。
若 $k' > x$，则占领，将城堡变为己方领地，此时城堡士兵数量 $x$ 变为 $k' - x$。
3. 王冠：继承占领城堡规则。
当玩家 PlayerA 的王冠被玩家 PlayerB 占领时，PlayerA 剩余所有领地均变为 PlayerB 领地，设 $k_i$ 为 PlayerA 第 $i$ 块领地的士兵数量，$k_i$ 变为 $\lfloor{k_i/2}\rfloor$。

## 游戏结束条件

|种类|描述|
|-|-|
|失败|己方王冠被其他玩家占领，即失败|
|胜利|其他所有玩家均已失败，即胜利|

## 士兵产生规则

1. 每个王冠/已被占领的城堡每刻开始时产生数量为 $1$ 的士兵。
2. 每轮开始时每个领地产生数量为 $1$ 士兵。
